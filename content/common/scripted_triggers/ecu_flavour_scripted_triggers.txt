# We use this as so we can overwrite it for the PD compatibility patch
ef_is_ecu = {
    is_planet_class = pc_city
}

# Planet scope
ef_is_valid_for_urbanisation = {
    is_artificial = no
    ef_is_ecu = no
    NOT = { is_planet_class = pc_relic}
    owner = {
        is_country_type = default
        NOR = {
            has_valid_civic = civic_agrarian_idyll
            is_gestalt = yes
            is_hive_empire = yes
            is_machine_empire = yes
            # The idea of a virtual empire having sprawling settlements is a bit silly.
            is_virtual_empire = yes
        }
    }
}
ef_has_population_density = {
    check_variable_arithmetic = {
        which = trigger:planet_size
        multiply = $DENSITY$
        value <= trigger:count_owned_pop
    }
}

ef_is_majority_urban = {
    check_variable_arithmetic = {
        which = value:ef_urbanisation_fraction
        value >= 0.5 # Unfortunately it seems we can't use params here
    }
}